<%- include('../includes/header') %>

<section class="auth-page">
  <div class="auth-container">
    <div class="auth-card">
      <h2>ğŸ“ KayÄ±t Ol</h2>
      <p class="auth-subtitle">KDS Sistemine Ãœye Olun</p>

      <form id="registerForm" class="auth-form">
        <div class="form-group">
          <label for="ad_soyad">Ad Soyad</label>
          <input 
            type="text" 
            id="ad_soyad" 
            name="ad_soyad" 
            placeholder="AdÄ±nÄ±z SoyadÄ±nÄ±z"
            minlength="3"
            required
          >
        </div>

        <div class="form-group">
          <label for="email">Email Adresi</label>
          <input 
            type="email" 
            id="email" 
            name="email" 
            placeholder="ornek@email.com"
            required
          >
        </div>

        <div class="form-group">
          <label for="sifre">Åifre</label>
          <input 
            type="password" 
            id="sifre" 
            name="sifre" 
            placeholder="En az 6 karakter"
            minlength="6"
            required
          >
        </div>

        <div class="form-group">
          <label for="sifre_tekrar">Åifre Tekrar</label>
          <input 
            type="password" 
            id="sifre_tekrar" 
            name="sifre_tekrar" 
            placeholder="Åifrenizi tekrar girin"
            minlength="6"
            required
          >
        </div>

        <div class="form-group checkbox-group">
          <input type="checkbox" id="terms" name="terms" required>
          <label for="terms">KullanÄ±m ÅŸartlarÄ±nÄ± kabul ediyorum</label>
        </div>

        <button type="submit" class="btn btn-primary btn-block">
          KayÄ±t Ol
        </button>
      </form>

      <div class="auth-footer">
        <p>Zaten hesabÄ±nÄ±z var mÄ±? <a href="/users/login">GiriÅŸ Yap</a></p>
      </div>
    </div>
  </div>
</section>

<script>
  document.getElementById('registerForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const sifre = document.getElementById('sifre').value;
    const sifre_tekrar = document.getElementById('sifre_tekrar').value;

    if (sifre !== sifre_tekrar) {
      alert('Åifreler eÅŸleÅŸmiyor!');
      return;
    }

    const formData = {
      ad_soyad: document.getElementById('ad_soyad').value,
      email: document.getElementById('email').value,
      sifre: sifre,
      sifre_tekrar: sifre_tekrar
    };

    try {
      const response = await fetch('/users/register', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      });

      const data = await response.json();

      if (data.status === 'success') {
        alert('KayÄ±t baÅŸarÄ±lÄ±! GiriÅŸ sayfasÄ±na yÃ¶nlendiriliyorsunuz.');
        window.location.href = '/users/login';
      } else {
        alert(data.message || 'KayÄ±t baÅŸarÄ±sÄ±z');
      }
    } catch (error) {
      alert('Bir hata oluÅŸtu: ' + error.message);
    }
  });
</script>

<%- include('../includes/footer') %>
